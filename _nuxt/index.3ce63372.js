import{b as f,a as h,p as b,q as g,o as r,h as l,F as v,r as S,u as x,s as y,i as d,t as R,v as O,x as k,k as w}from"./entry.4ac45427.js";import"./app.config.1ffa0184.js";const B=""+new URL("bubble.b5261579.png",import.meta.url).href,u=s=>(O("data-v-5cf49e47"),s=s(),k(),s),E=u(()=>d("img",{src:B,alt:"Bubble"},null,-1)),I=u(()=>d("h1",{class:"text-white text-center"},"Hello",-1)),C={class:"text-white text-center"},L=f({__name:"index",setup(s){const a=h(),_=b(),o=g([]),n=new WebSocket(`${a.public.WEBSOCKET_BASE_URL}/events`);let c=0;const p=()=>`${(.25+Math.random()/2)*100}vw`;return n.onmessage=function(i){const t=JSON.parse(i.data);if(t.action==="greet")++c,(e=>{o.value.push({id:c,position:p(),user:t.data.user}),setTimeout(()=>o.value=o.value.filter(({id:m})=>m!==e),7e3)})(c);else if(t.action==="redeem"&&t.data.reward===a.public.COLOR_REWARD_ID){const e=t.data.message.startsWith("#")?t.data.message.substr(1):t.data.message;/^[0-9A-F]{6}$/i.test(e)?fetch(`${a.public.MEROSS_BASE_URL}/set_devices_color`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({devices:["Lampe de salon","Chevet salon"],color:e})}):console.error(`Incorrect hex value redeemed : ${e}`)}},n.onopen=i=>n.send(JSON.stringify({action:"auth",key:_.query.key})),(i,t)=>(r(),l("main",null,[(r(!0),l(v,null,S(x(o),e=>(r(),l("div",{key:e.id,class:"floating-bubble",style:y({left:e.position})},[E,I,d("h2",C,R(e.user),1)],4))),128))]))}});const N=w(L,[["__scopeId","data-v-5cf49e47"]]);export{N as default};
